package jp.gr.java_conf.daisy.ajax_mutator.mutation_viewer;

import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;

/**
 * Viewer for mutatnts generated by AjaxMutator.
 */
public class MutationViewer extends Application {
    private static final String WINDOW_TITLE = "AjaxMutator - MutationViewer";
    private static final String BASE_DIRECTORY_KEY = "base_dir";
    private static final String MUTANTS_DIRECTORY_KEY = "mutants_dir";

    @Override
    public void start(Stage stage) throws Exception{
        checkArgs();
        FXMLLoader loader = new FXMLLoader(getClass().getResource("/mutation_viewer/mutation_viewer.fxml"));
        loader.setController(new MutationViewerController(
                getParameters().getNamed().get(MUTANTS_DIRECTORY_KEY),
                getParameters().getNamed().get(BASE_DIRECTORY_KEY)));
        Parent root = (Parent) loader.load();
        stage.setTitle(WINDOW_TITLE);
        stage.setScene(new Scene(root));
        stage.show();
    }

    private void checkArgs() throws IllegalArgumentException {
        if (!getParameters().getNamed().containsKey(MUTANTS_DIRECTORY_KEY)) {
            throw new IllegalArgumentException("You must specify the directory of mutants as following parameter\n" +
                    "'--" + MUTANTS_DIRECTORY_KEY + "=(path)");
        }
        if (!getParameters().getNamed().containsKey(BASE_DIRECTORY_KEY)) {
            throw new IllegalArgumentException("You must specify base directory as following parameter\n" +
                    "'--" + BASE_DIRECTORY_KEY + "=(path)");
        }
    }

    public static void main(String[] args) {
        launch(args);
    }
}
